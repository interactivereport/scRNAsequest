<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Running the pipeline | scRNASequest: an ecosystem of scRNA-seq analysis, visualization and publishing</title>
  <meta name="description" content="Chapter 7 Running the pipeline | scRNASequest: an ecosystem of scRNA-seq analysis, visualization and publishing" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Running the pipeline | scRNASequest: an ecosystem of scRNA-seq analysis, visualization and publishing" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Running the pipeline | scRNASequest: an ecosystem of scRNA-seq analysis, visualization and publishing" />
  
  
  



<meta name="date" content="2023-08-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="input-configuration.html"/>
<link rel="next" href="differential-expression-de-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">scRNASequest</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>3</b> Installation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="installation.html"><a href="installation.html#install-scrnasequest"><i class="fa fa-check"></i><b>3.1</b> Install scRNASequest</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="installation.html"><a href="installation.html#installation-using-conda"><i class="fa fa-check"></i><b>3.1.1</b> Installation using Conda</a></li>
<li class="chapter" data-level="3.1.2" data-path="installation.html"><a href="installation.html#installation-through-docker"><i class="fa fa-check"></i><b>3.1.2</b> Installation through Docker</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="installation.html"><a href="installation.html#configure-sys.yml-file"><i class="fa fa-check"></i><b>3.2</b> Configure sys.yml file</a></li>
<li class="chapter" data-level="3.3" data-path="installation.html"><a href="installation.html#install-cellxgene-vip"><i class="fa fa-check"></i><b>3.3</b> Install cellxgene VIP</a></li>
<li class="chapter" data-level="3.4" data-path="installation.html"><a href="installation.html#install-celldepot"><i class="fa fa-check"></i><b>3.4</b> Install CellDepot</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="demo-run.html"><a href="demo-run.html"><i class="fa fa-check"></i><b>4</b> Demo run</a>
<ul>
<li class="chapter" data-level="4.1" data-path="demo-run.html"><a href="demo-run.html#demo-run-with-conda"><i class="fa fa-check"></i><b>4.1</b> Demo run with Conda</a></li>
<li class="chapter" data-level="4.2" data-path="demo-run.html"><a href="demo-run.html#demo-run-with-docker"><i class="fa fa-check"></i><b>4.2</b> Demo run with Docker</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-preparation.html"><a href="data-preparation.html"><i class="fa fa-check"></i><b>5</b> Data preparation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-preparation.html"><a href="data-preparation.html#public-data-in-h5-format"><i class="fa fa-check"></i><b>5.1</b> Public data in h5 format</a></li>
<li class="chapter" data-level="5.2" data-path="data-preparation.html"><a href="data-preparation.html#public-data-in-10x-mex-format"><i class="fa fa-check"></i><b>5.2</b> Public data in 10X MEX format</a></li>
<li class="chapter" data-level="5.3" data-path="data-preparation.html"><a href="data-preparation.html#self-prepared-files"><i class="fa fa-check"></i><b>5.3</b> Self-prepared files</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="input-configuration.html"><a href="input-configuration.html"><i class="fa fa-check"></i><b>6</b> Input configuration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="input-configuration.html"><a href="input-configuration.html#generate-template-files"><i class="fa fa-check"></i><b>6.1</b> Generate template files</a></li>
<li class="chapter" data-level="6.2" data-path="input-configuration.html"><a href="input-configuration.html#prepare-the-config.yml-file"><i class="fa fa-check"></i><b>6.2</b> Prepare the config.yml file</a></li>
<li class="chapter" data-level="6.3" data-path="input-configuration.html"><a href="input-configuration.html#section52"><i class="fa fa-check"></i><b>6.3</b> Prepare the sample meta file</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="input-configuration.html"><a href="input-configuration.html#h5-input"><i class="fa fa-check"></i><b>6.3.1</b> h5 input</a></li>
<li class="chapter" data-level="6.3.2" data-path="input-configuration.html"><a href="input-configuration.html#mex-input"><i class="fa fa-check"></i><b>6.3.2</b> MEX input</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="input-configuration.html"><a href="input-configuration.html#file-hierarchy"><i class="fa fa-check"></i><b>6.4</b> File hierarchy</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="running-the-pipeline.html"><a href="running-the-pipeline.html"><i class="fa fa-check"></i><b>7</b> Running the pipeline</a>
<ul>
<li class="chapter" data-level="7.1" data-path="running-the-pipeline.html"><a href="running-the-pipeline.html#initial-scanalyzer-run"><i class="fa fa-check"></i><b>7.1</b> Initial scAnalyzer run</a></li>
<li class="chapter" data-level="7.2" data-path="running-the-pipeline.html"><a href="running-the-pipeline.html#review-the-bookdown-report"><i class="fa fa-check"></i><b>7.2</b> Review the bookdown report</a></li>
<li class="chapter" data-level="7.3" data-path="running-the-pipeline.html"><a href="running-the-pipeline.html#generate-a-slide-deck"><i class="fa fa-check"></i><b>7.3</b> Generate a slide deck</a></li>
<li class="chapter" data-level="7.4" data-path="running-the-pipeline.html"><a href="running-the-pipeline.html#doublet-detection"><i class="fa fa-check"></i><b>7.4</b> Doublet detection</a></li>
<li class="chapter" data-level="7.5" data-path="running-the-pipeline.html"><a href="running-the-pipeline.html#cell-type-label-transfer"><i class="fa fa-check"></i><b>7.5</b> Cell type label transfer</a></li>
<li class="chapter" data-level="7.6" data-path="running-the-pipeline.html"><a href="running-the-pipeline.html#adjust-major_cluster_rate"><i class="fa fa-check"></i><b>7.6</b> Adjust major_cluster_rate</a></li>
<li class="chapter" data-level="7.7" data-path="running-the-pipeline.html"><a href="running-the-pipeline.html#run-the-pipeline-in-parallel"><i class="fa fa-check"></i><b>7.7</b> Run the pipeline in parallel</a></li>
<li class="chapter" data-level="7.8" data-path="running-the-pipeline.html"><a href="running-the-pipeline.html#run-the-full-analysis"><i class="fa fa-check"></i><b>7.8</b> Run the full analysis</a></li>
<li class="chapter" data-level="7.9" data-path="running-the-pipeline.html"><a href="running-the-pipeline.html#visualize-the-harmonized-results"><i class="fa fa-check"></i><b>7.9</b> Visualize the harmonized results</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="differential-expression-de-analysis.html"><a href="differential-expression-de-analysis.html"><i class="fa fa-check"></i><b>8</b> Differential expression (DE) analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="differential-expression-de-analysis.html"><a href="differential-expression-de-analysis.html#example-1"><i class="fa fa-check"></i><b>8.1</b> Example 1</a></li>
<li class="chapter" data-level="8.2" data-path="differential-expression-de-analysis.html"><a href="differential-expression-de-analysis.html#example-2"><i class="fa fa-check"></i><b>8.2</b> Example 2</a></li>
<li class="chapter" data-level="8.3" data-path="differential-expression-de-analysis.html"><a href="differential-expression-de-analysis.html#example-3"><i class="fa fa-check"></i><b>8.3</b> Example 3</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="reference-building.html"><a href="reference-building.html"><i class="fa fa-check"></i><b>9</b> Reference building</a>
<ul>
<li class="chapter" data-level="9.1" data-path="reference-building.html"><a href="reference-building.html#initialize-scref"><i class="fa fa-check"></i><b>9.1</b> Initialize scRef</a></li>
<li class="chapter" data-level="9.2" data-path="reference-building.html"><a href="reference-building.html#submit-scref"><i class="fa fa-check"></i><b>9.2</b> Submit scRef</a></li>
<li class="chapter" data-level="9.3" data-path="reference-building.html"><a href="reference-building.html#demo-scref"><i class="fa fa-check"></i><b>9.3</b> Demo scRef</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="celldepot-publishing.html"><a href="celldepot-publishing.html"><i class="fa fa-check"></i><b>10</b> CellDepot publishing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="celldepot-publishing.html"><a href="celldepot-publishing.html#initialize-sc2celldepot"><i class="fa fa-check"></i><b>10.1</b> Initialize sc2celldepot</a></li>
<li class="chapter" data-level="10.2" data-path="celldepot-publishing.html"><a href="celldepot-publishing.html#run-sc2celldepot"><i class="fa fa-check"></i><b>10.2</b> Run sc2celldepot</a></li>
<li class="chapter" data-level="10.3" data-path="celldepot-publishing.html"><a href="celldepot-publishing.html#demo-sc2celldepot"><i class="fa fa-check"></i><b>10.3</b> Demo sc2celldepot</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="additional-tools.html"><a href="additional-tools.html"><i class="fa fa-check"></i><b>11</b> Additional tools</a>
<ul>
<li class="chapter" data-level="11.1" data-path="additional-tools.html"><a href="additional-tools.html#scrmambient"><i class="fa fa-check"></i><b>11.1</b> scRMambient</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="additional-tools.html"><a href="additional-tools.html#set-up-the-inputs"><i class="fa fa-check"></i><b>11.1.1</b> Set up the inputs</a></li>
<li class="chapter" data-level="11.1.2" data-path="additional-tools.html"><a href="additional-tools.html#run-scrmambient"><i class="fa fa-check"></i><b>11.1.2</b> Run scRMambient</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="additional-tools.html"><a href="additional-tools.html#scdeg"><i class="fa fa-check"></i><b>11.2</b> scDEG</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="additional-tools.html"><a href="additional-tools.html#initialize-scdeg"><i class="fa fa-check"></i><b>11.2.1</b> Initialize scDEG</a></li>
<li class="chapter" data-level="11.2.2" data-path="additional-tools.html"><a href="additional-tools.html#run-de-analysis"><i class="fa fa-check"></i><b>11.2.2</b> Run DE analysis</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="additional-tools.html"><a href="additional-tools.html#sctool"><i class="fa fa-check"></i><b>11.3</b> scTool</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="additional-tools.html"><a href="additional-tools.html#remove-annotations"><i class="fa fa-check"></i><b>11.3.1</b> Remove annotations</a></li>
<li class="chapter" data-level="11.3.2" data-path="additional-tools.html"><a href="additional-tools.html#add-annotations"><i class="fa fa-check"></i><b>11.3.2</b> Add annotations</a></li>
<li class="chapter" data-level="11.3.3" data-path="additional-tools.html"><a href="additional-tools.html#export-gene-expressions"><i class="fa fa-check"></i><b>11.3.3</b> Export gene expressions</a></li>
<li class="chapter" data-level="11.3.4" data-path="additional-tools.html"><a href="additional-tools.html#pseudo-bulk-aggregation"><i class="fa fa-check"></i><b>11.3.4</b> Pseudo-bulk aggregation</a></li>
<li class="chapter" data-level="11.3.5" data-path="additional-tools.html"><a href="additional-tools.html#demo-sctool"><i class="fa fa-check"></i><b>11.3.5</b> Demo scTool</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="miscellaneous.html"><a href="miscellaneous.html"><i class="fa fa-check"></i><b>12</b> Miscellaneous</a>
<ul>
<li class="chapter" data-level="12.1" data-path="miscellaneous.html"><a href="miscellaneous.html#cell-subsetting"><i class="fa fa-check"></i><b>12.1</b> Cell subsetting</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">scRNASequest: an ecosystem of scRNA-seq analysis, visualization and publishing</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="running-the-pipeline" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Running the pipeline<a href="running-the-pipeline.html#running-the-pipeline" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>If you would like to perform ambient RNA removal using CellBender, please follow the instruction here to run <strong>scRMambient</strong> first. The <strong>scRMambient</strong> pipeline will run CellBender based on unfiltered h5 input files and created new h5 files to run scAnalyzer. We have a <a href="https://interactivereport.github.io/scRNAsequest/tutorial/docs/additional-tools.html#scrmambient">detailed tutorial</a>.</p>
<p>After preparing the input data and configuration files (config.yml and sampleMeta.csv), we are ready to run the pipeline. Please be aware that scRNASequest is a semi-automated pipeline, and certain steps require the user to review the outputs and determine the parameters. Thus, the same step may need to be run for more than once, especially for finaling the QC parameters.</p>
<div id="initial-scanalyzer-run" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Initial scAnalyzer run<a href="running-the-pipeline.html#initial-scanalyzer-run" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The initial scAnalyzer run intends to test the default filtering parameters on the single-cell RNA-seq data. We suggest the following settings in the config.yml file to activate the filtering step, but pause the pipeline from additional analysis (such as data integration, harmonization, etc.):</p>
<pre><code># Change the following settings in the config.yml file:
filter_step: True
runAnalysis: False</code></pre>
<p>To run scAnalyzer, simply pass the path to the config.yml file to the program:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb46-1"><a href="running-the-pipeline.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="ex">scAnalyzer</span> Path/to/a/config/file</span>
<span id="cb46-2"><a href="running-the-pipeline.html#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="running-the-pipeline.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Example:</span></span>
<span id="cb46-4"><a href="running-the-pipeline.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="ex">scAnalyzer</span> ~/E-MTAB-11115/processing/config.yml</span></code></pre></div>
<p>Output files:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="running-the-pipeline.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="ex">outputdir</span></span>
<span id="cb47-2"><a href="running-the-pipeline.html#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">├──</span> BookdownReport/                <span class="co">#Full bookdown report folder. This is same as the BookdownReport.tar.gz below</span></span>
<span id="cb47-3"><a href="running-the-pipeline.html#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">├──</span> config.yml</span>
<span id="cb47-4"><a href="running-the-pipeline.html#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="ex">├──</span> config.yml.20220617.log        <span class="co">#log file</span></span>
<span id="cb47-5"><a href="running-the-pipeline.html#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="ex">├──</span> ProjName_BookdownReport.tar.gz <span class="co">#Bookdown report tar ball. </span></span>
<span id="cb47-6"><a href="running-the-pipeline.html#cb47-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="co">#Please download this file and open the index.html file to view the report</span></span>
<span id="cb47-7"><a href="running-the-pipeline.html#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="ex">├──</span> ProjName_raw_prefilter.h5ad    <span class="co">#h5ad after pre-filtering</span></span>
<span id="cb47-8"><a href="running-the-pipeline.html#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="ex">├──</span> prefilter.QC.pdf               <span class="co">#QC plots before filtering. These plots are included in the Bookdown report</span></span>
<span id="cb47-9"><a href="running-the-pipeline.html#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="ex">├──</span> postfilter.QC.pdf              <span class="co">#QC plots after filtering</span></span>
<span id="cb47-10"><a href="running-the-pipeline.html#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="ex">└──</span> Rmarkdown/                     <span class="co">#Source files for the Bookdown report</span></span></code></pre></div>
</div>
<div id="review-the-bookdown-report" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Review the bookdown report<a href="running-the-pipeline.html#review-the-bookdown-report" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After the initial <code>scAnalyzer</code> run, a bookdown report, named <strong>ProjName_BookdownReport.tar.gz</strong> will be generated. Please open the report (index.html) to review cell numbers and figures before and after the filtering step, and adjust the following thresholds in the config.yml file if needed:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb48-1"><a href="running-the-pipeline.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cell filtering parameters in the config.yml file:</span></span>
<span id="cb48-2"><a href="running-the-pipeline.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="ex">gene_group:</span></span>
<span id="cb48-3"><a href="running-the-pipeline.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="ex">MT:</span></span>
<span id="cb48-4"><a href="running-the-pipeline.html#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="ex">startwith:</span> [<span class="st">&quot;MT-&quot;</span>,<span class="st">&quot;Mt-&quot;</span>,<span class="st">&quot;mt-&quot;</span>]</span>
<span id="cb48-5"><a href="running-the-pipeline.html#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="ex">cutoff:</span> 20           <span class="co">#percentage cutoff to filter out the cells (larger than this cutoff)</span></span>
<span id="cb48-6"><a href="running-the-pipeline.html#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="ex">rm:</span> False</span>
<span id="cb48-7"><a href="running-the-pipeline.html#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="ex">RP:</span>                    <span class="co">#for ribosomal genes if you would like to filter them</span></span>
<span id="cb48-8"><a href="running-the-pipeline.html#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="ex">startwith:</span> []</span>
<span id="cb48-9"><a href="running-the-pipeline.html#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="ex">cutoff:</span> 20</span>
<span id="cb48-10"><a href="running-the-pipeline.html#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="ex">rm:</span> False</span>
<span id="cb48-11"><a href="running-the-pipeline.html#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="ex">filter_step:</span> True        <span class="co">#if False, the above &#39;gene_group&#39; filtering will be skipped as well</span></span>
<span id="cb48-12"><a href="running-the-pipeline.html#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="ex">min.cells:</span> 3             <span class="co">#filtering genes by minimum number of cells with non-zero count for a gene</span></span>
<span id="cb48-13"><a href="running-the-pipeline.html#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="ex">min.features:</span> 50         <span class="co">#filtering cells by minimal genes detected</span></span>
<span id="cb48-14"><a href="running-the-pipeline.html#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="ex">highCount.cutoff:</span> 10000  <span class="co">#any cells with higher total counts to be removed</span></span>
<span id="cb48-15"><a href="running-the-pipeline.html#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="ex">highGene.cutoff:</span> 3000    <span class="co">#any cells with a higher number of detected genes to be removed</span></span></code></pre></div>
<p>The <strong>min.cells</strong> cutoff is to filter out <em>genes</em> that have low representation in cells, and the <strong>min.features</strong> cutoff is to filter out <em>cells</em> that have low number of genes (features) detected. The last two cutoffs, <strong>highCount.cutoff</strong> and <strong>highGene.cutoff</strong> can be used to filter cells if they have too many total counts or UMI detected, possibly due to multiplets. Please evaluate these cutoffs carefully, because the default values here may not be suitable for all datasets.</p>
<p>The user may need to adjust the thresholds and rerun <code>scAnalyzer</code> to visualize the results. This step may be repeated until the threshold is adequate for the data.</p>
<p>Please find an example of the bookdown report here: <a href="https://interactivereport.github.io/scRNAsequest/examples/E-MTAB-11115/bookdown/index.html" target="_blank">E-MTAB-11115 bookdown</a></p>
</div>
<div id="generate-a-slide-deck" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Generate a slide deck<a href="running-the-pipeline.html#generate-a-slide-deck" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This is an optional step if you have already reviewed the Bookdown report. This slide deck is another way to organize and present the same results.</p>
<p>The QC report can be turned into a online slide deck format for better sharing and demonstration. To achieve this, please use the <strong>Slidedeck.Rmd</strong> file under the /src folder and follow the steps below:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="running-the-pipeline.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a new directory inside the project, and link the existed files and folder:</span></span>
<span id="cb49-2"><a href="running-the-pipeline.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~/E-MTAB-11115/processing/</span>
<span id="cb49-3"><a href="running-the-pipeline.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> Slidedeck <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> Slidedeck</span>
<span id="cb49-4"><a href="running-the-pipeline.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> ../BookdownReport/images</span>
<span id="cb49-5"><a href="running-the-pipeline.html#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ln</span> <span class="at">-s</span> ../BookdownReport/bookdown.info.txt</span>
<span id="cb49-6"><a href="running-the-pipeline.html#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="running-the-pipeline.html#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy the Slidedeck.Rmd file from src directory to the working directory containing config.yml file.</span></span>
<span id="cb49-8"><a href="running-the-pipeline.html#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We assume your pipeline was installed under ~/scRNAsequest/</span></span>
<span id="cb49-9"><a href="running-the-pipeline.html#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> ~/scRNAsequest/src/Slidedeck.Rmd ~/E-MTAB-11115/processing/Slidedeck</span>
<span id="cb49-10"><a href="running-the-pipeline.html#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="running-the-pipeline.html#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Source the environment</span></span>
<span id="cb49-12"><a href="running-the-pipeline.html#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="va">src</span><span class="op">=</span><span class="st">&quot;~/scRNAsequest/src&quot;</span></span>
<span id="cb49-13"><a href="running-the-pipeline.html#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> <span class="va">$src</span>/.env<span class="kw">;</span><span class="bu">eval</span> <span class="va">$condaEnv</span></span>
<span id="cb49-14"><a href="running-the-pipeline.html#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="running-the-pipeline.html#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the Slidedeck script, and set the output file name using &#39;output_file&#39; parameter</span></span>
<span id="cb49-16"><a href="running-the-pipeline.html#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="ex">Rscript</span> <span class="at">-e</span> <span class="st">&#39;rmarkdown::render(&quot;Slidedeck.Rmd&quot;, output_file=&quot;Output.html&quot;)&#39;</span></span></code></pre></div>
<p>Please download <strong>the whole Slidedeck directory</strong> and open the <strong>Output.html</strong> file in a web browser.</p>
<p>Please find an example of the bookdown report here: <a href="https://interactivereport.github.io/scRNAsequest/examples/E-MTAB-11115/slidedeck/index.html" target="_blank">E-MTAB-11115 slidedeck</a></p>
</div>
<div id="doublet-detection" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Doublet detection<a href="running-the-pipeline.html#doublet-detection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Based on the recent <a href="https://www.sciencedirect.com/science/article/pii/S2405471220304592">benchmarking paper</a> and single-cell RNA-seq analysis <a href="https://www.nature.com/articles/s41576-023-00586-w">guideline</a>, we implement <a href="https://github.com/plger/scDblFinder"><strong>scDblFinder</strong></a> in our pipeline to perform doublet detection. By default, the pipeline runs scDblFinder on each sample and produces doublet scores (0-1, higher means high probability to be doublet) and classification results (singlet or doublet) using its own cutoff. If you speculate ambient RNA contamination in your data, we also suggest running <a href="https://interactivereport.github.io/scRNAsequest/tutorial/docs/additional-tools.html#scrmambient">scRMambient</a> first.</p>
<p>Users can control whether to remove these cells by setting <code>dbl_filter</code> in the config.yml file. <code>False</code> means not removing doublets, but the score (column name: scDblFinder.score) and classification (column name: scDblFinder.class) will be added to the final results for evaluation. If <code>True</code>, then all doublets will be removed.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="running-the-pipeline.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="ex">dbl_filter:</span> False</span></code></pre></div>
<p>The scDblFinder automatically determines the doublet rates based on cell number, i.e., for N thousand cells, the doublet rate will be close to N %.</p>
<p>However, you can adjust this manually by providing a numeric number between 0~1 in the config.yml file to enforce your own cutoff on the doublet score:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb51-1"><a href="running-the-pipeline.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="ex">dbl_filter:</span> 0.95</span></code></pre></div>
</div>
<div id="cell-type-label-transfer" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Cell type label transfer<a href="running-the-pipeline.html#cell-type-label-transfer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Cell type label transfer is to label our new data using a reference single-cell RNA-seq data from the same tissue (i.e. brain, muscle, etc.). It automatically assigns cell types to each single cell. scRNASequest pipeline can do this if you provide a reference in the <strong>config.yml</strong> file.</p>
<p>However, this is optional, so leaving ‘ref_name’ parameter as blank won’t affect running the pipeline. But we strongly suggest you perform label transfer to better understand the biology of the data.</p>
<p>To check all available references, run scAnalyzer without any parameter and they will be printed out on the screen if you have added any references using scRef, see section <a href="reference-building.html#reference-building">Reference building</a>. Alternatively, you can provide your own reference in <a href="https://azimuth.hubmapconsortium.org/references/">Azimuth format</a> to the pipeline.</p>
<p>Example 1, if you have a named reference that has been added to the pipeline, for example, human_cortex is included already:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb52-1"><a href="running-the-pipeline.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ref_name:</span> human_cortex</span></code></pre></div>
<p>Example 2, if you have an rds with cell type labels, you can also provide a path to the reference file and use it to label the current dataset. In the <a href="https://github.com/interactivereport/scRNAsequest/tree/main/demo/ref">demo dataset</a>, we have a reference rds file prepared and you can use it directly:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb53-1"><a href="running-the-pipeline.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ref_name:</span> ~/scRNAsequest/rat_cortex_ref.rds</span></code></pre></div>
<p>The above rds file must be in <a href="https://azimuth.hubmapconsortium.org/references/">Azimuth format</a>, which can be prepared by running scRef.</p>
</div>
<div id="adjust-major_cluster_rate" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Adjust major_cluster_rate<a href="running-the-pipeline.html#adjust-major_cluster_rate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you have turned on cell type label transfer by providing a reference dataset, you may consider adjusting <strong>major_cluster_rate</strong> in the config.yml file. This major cluster rate means the proportion (by default 0.7) of cells of an integration cluster to be assigned to a Seurat reference label.</p>
<p>In the final cell type labels, the <strong>predicted.celltype</strong> is the the labels predicted by Seurat label transfer. The following predicted labels: <strong>liger_cluster_predicted.celltype</strong>, <strong>normalized.louvain_predicted.celltype</strong>, <strong>raw.louvain_predicted.celltype</strong>, and <strong>sctHarmony_cluster.predicted.celltype</strong> are re-labelled cell types considering dimension reduction/integration clusters. The dimension reduction/integration algorithms generate numeric clusters, and our pipeline will look through each cluster and check if over 0.7 (by default, 70%) of the cells belong to one label. If yes, the whole cluster will be assigned to that cell type label. If not, it will leave that numeric cluster in the final result. We can consider those numeric labeling as a mixture or ‘Unclassified’ cell types.</p>
<p>So, if you find cell type labels with just numbers and you don’t want to see them (The numbers indicating original cluster id whose cells belong to any label is lower than the threshold), you can turn this off by removing the default number 0.7 and leaving it empty like this in the config.yml file:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="running-the-pipeline.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="ex">major_cluster_rate:</span></span></code></pre></div>
</div>
<div id="run-the-pipeline-in-parallel" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Run the pipeline in parallel<a href="running-the-pipeline.html#run-the-pipeline-in-parallel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As mentioned in the previous section <a href="input-configuration.html#input-configuration">Input configuration</a>, users can choose <strong>sge</strong> or <strong>slurm</strong> based on your scheduler option in the <strong>config.yml</strong> file to run your jobs parallelly. For large datasets, we highly recommend that users make full use of the CPU parallelization. Here is an example of using 8 cores on slurm HPC scheduler, in the config.yml file:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb55-1"><a href="running-the-pipeline.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="ex">parallel:</span> slurm              <span class="co">#False by default. Use &#39;slurm&#39; for Edge cluster, and use &#39;sge&#39; for Cambridge HPC</span></span>
<span id="cb55-2"><a href="running-the-pipeline.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="ex">core:</span> 8                      <span class="co">#Number of cores to use</span></span></code></pre></div>
<p>If you don’t have <strong>sge</strong> or <strong>slurm</strong> scheduler, simply use ‘parallel: False’ as default.</p>
</div>
<div id="run-the-full-analysis" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Run the full analysis<a href="running-the-pipeline.html#run-the-full-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have finalized the filtering criteria and made necessary adjustment in the config.yml file to set up label transfer, major_cluster_rate, and parallelization.</p>
<p>Now, we are ready to turn on the <em>runAnalysis</em> parameter in the config.yml and run the full pipeline:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb56-1"><a href="running-the-pipeline.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the following setting in the config.yml file:</span></span>
<span id="cb56-2"><a href="running-the-pipeline.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="ex">runAnalysis:</span> True</span>
<span id="cb56-3"><a href="running-the-pipeline.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="ex">overwrite:</span> True    <span class="co">#Overwrite the previous results if we run this again, for example, after adjusting some parameters.</span></span></code></pre></div>
<p>You can always go to our <a href="https://github.com/interactivereport/scRNAsequest/tree/main/demo">demo dataset</a> to review related data and <a href="https://github.com/interactivereport/scRNAsequest/blob/main/demo/config.yml">demo config.yml</a> settings.</p>
<p>Then run the following command again:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb57-1"><a href="running-the-pipeline.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="ex">scAnalyzer</span> Path/to/a/config/file</span>
<span id="cb57-2"><a href="running-the-pipeline.html#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="running-the-pipeline.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Example:</span></span>
<span id="cb57-4"><a href="running-the-pipeline.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="ex">scAnalyzer</span> ~/E-MTAB-11115/processing/config.yml</span></code></pre></div>
<p>This step will be time-consuming, and it took ~1 hour for the <a href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-11115/" target="_blank">E-MTAB-11115</a> data (final cell number: 29,511) to finish. For a larger dataset with 110k cells we have tested, the full pipeline took ~7 hours.</p>
</div>
<div id="visualize-the-harmonized-results" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> Visualize the harmonized results<a href="running-the-pipeline.html#visualize-the-harmonized-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After running the pipeline, you will see the following files in the working directory. Each harmonization method (Harmony, Seurat, Liger) will also generate corresponding files.</p>
<pre><code>outputdir
    # Input files
        ├── config.yml:      The analysis config file specify the scAnalyzer parameters
        ├── sampleMeta.csv:  List all sample information including expression matrix (and sample/cell level meta information)
        └── DEGinfo.csv:     Define the sc DEG (between phenotypes within a cluster annotatino)
    # Main results under the output dir:
        ├── [prj_name].h5ad:           The final h5ad file which is used for cellxgene VIP loading (will be copied into the celldepotDir folder set by sys.yml)
        ├── [prj_name].db:             The final db file which is used for cellxgene VIP loading (will be copied into the celldepotDir folder set by sys.yml)
        ├── [prj_name].h5seurat:       The h5seurat file of the final results
        └── [prj_name]_raw_added.h5ad: The h5ad file contains raw counts in X along with all annotation and embeding 
                                          (will be copied into celldepot folder)
    # Rmarkdown:
        ├── Rmarkdown:                 The folder contains png files for R bookdown
        ├── [prj_name]_BookdownReport.tar.gz: R bookdown document tarball for downloading and sharing
        └── BookdownReport:            The folder contains R bookdown reports
    # Log file:
        └── config.yml.[date].log:  All stdout/stderr will be recorded in this dated log file
        └── [Software].error:       Standard error files of multiple software, including: 
                                        Harmony, Liger, SeuratRPCA, SeuratRef, SCT, sctHarmony, silhouette, etc.
                                    These files will be under the log/ directory if you did not run in the parallel mode
                                    These files will be under the j[numeric] folder if you ran the pipeline in the parallel mode
    # QC files under the QC/ folder:
        ├── sequencingQC.csv:   Merged all sequence QC files from individual samples if available
        ├── sequencingQC.pdf:   Plots of sequence QC if they are available
        ├── prefilter.QC.pdf:   Initial data QC plots without filtering
        └── postfilter.QC.pdf:  Data QC plots after filtering
    # evaluation folder for harmonization evaluation:
        ├── [prj_name]_kBET_umap_k0_100.pdf          The kBET evaluation plot for all integration methods
        └── [prj_name]_Silhouette_boxplot_pc50.pdf   The Silhouette evaluation plot for all integration methods
    # raw/ folder for h5ad files before and after QC, but have not run through the pipeline:
        ├── [prj_name]_raw_prefilter.h5ad: The internal temporary raw counts created/merged directly from sample before filtering 
        └── [prj_name]_raw.h5ad:           The internal temporary raw counts after the cell/gene filtering
    # SCT/ folder:
        ├── [prj_name].h5:        The sparse matrix contains SCT expression values
        ├── [prj_name].h5.rds:    The Seurat object contains counts (RNA assay) and 
                                      SCT expression (SCT assay) along with original meta information from SampleMeta file
        ├── [prj_name].cID        Cell barcodes
        ├── [prj_name].gID        Gene ID
        ├── [prj_name].scalF      Scale factor
        └── [prj_name].h5ad:      The SCT expression, along with PCA, tSNE, UMAP reduction layout, will be 
                                      merged into [prj_name].h5ad
    # SeuratRPCA folder for Seurat RPCA integration results:
        ├── [prj_name].csv.gz:    The reuction embedding and clustering results from seurat RPCA integration 
        └── [prj_name].h5ad:      The seurat RPCA integration with reduction embedding and clustering, 
                                      will be merged into [prj_name].h5ad
    # SeuratRef folder for Seurat reference mapping results:
        ├── [prj_name].csv:       The reuction embedding and label transfer results from seurat RPCA integration 
        └── [prj_name].h5ad:      The seurat reference mapping results with reduction embedding, will be merged into [prj_name].h5ad
    # sctHarmony folder for Harmony based on SCT transformation:
        ├── [prj_name].csv:       The PCA iinformation of each cell
        └── [prj_name].h5ad:      The harmony integration with reduction embedding and clustering, 
                                      will be merged into [prj_name].h5ad
    # Liger folder for Liger integration results:
        ├── [prj_name]_hvg.csv:  High variable gene list
        ├── [prj_name].csv:      The liger integration embedding and cluster
        └── [prj_name].h5ad&quot;:    The liger integration with reduction embedding and clustering, 
                                          will be merged into [prj_name].h5ad
    # [prj_name]_scDEG folder (if you ran the DEG step):
        ├── Comparisone names folders
          ├── .csv files for each cell type: The DEG analysis results
          ├── .rds files for each cell type: The rds data
          └── .pnd files for each cell type: The volcano plots
    # Parallel directory (if you ran the pipeline in parallel mode):
        └── j[numeric]:                A colder contains parallel jobs submit script and log file</code></pre>
<p><a href="https://www.nature.com/articles/s41592-018-0254-1" target="_blank">kBET</a> is a useful metric to evaluate and compare the harmonization results. Here is an example of the <strong>ProjName_kBET_umap_k0_100.pdf</strong> result:</p>
<p><a href="https://interactivereport.github.io/scRNAsequest/tutorial/images/kBET.png"><img src="https://interactivereport.github.io/scRNAsequest/tutorial/images/kBET.png" /></a></p>
<p>Please review the <strong>ProjName.h5ad</strong> file for the harmonization result. If you have <a href="https://github.com/interactivereport/cellxgene_VIP" target="_blank">Cellxgene VIP</a> installed, the visualization will be easier.</p>
<p>Here is an example of the ProjName.h5ad project visualized by <a href="https://github.com/interactivereport/cellxgene_VIP" target="_blank">Cellxgene VIP</a>:</p>
<p><a href="https://interactivereport.github.io/scRNAsequest/tutorial/images/UMAP.png"><img src="https://interactivereport.github.io/scRNAsequest/tutorial/images/UMAP.png" /></a></p>
<p><strong>Update on August 2023: covariate checking</strong></p>
<p>Now the pipeline will also output two additional files for pair-wised correlation analysis of covariates in obs:</p>
<ul>
<li><p>obsCor.csv: pair-wised p values</p></li>
<li><p>obsCor.pdf: all pair-wised plots</p></li>
</ul>
<p>If both are numeric, a scatter plot with correlation test.</p>
<p>If one is numeric while the other is categorical, a boxplot with one-way anova test.</p>
<p>If both are categorical, a barplot (cell number) with chi-square test, and a contingency table will be plotted for these two categorical variables.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="input-configuration.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="differential-expression-de-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/interactivereport/scRNAsequest/edit/gh-pages/07-RunningThePipeline.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/interactivereport/scRNAsequest/blob/gh-pages/07-RunningThePipeline.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
